\documentclass[a4paper,10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{fancyvrb}
\pagestyle{fancy}

%generate mono-spaced
\def\code#1{\texttt{#1}}

\rhead{}
\lfoot{noise}
\cfoot{}
\rfoot{\thepage}
\renewcommand{\footrulewidth}{0.4pt}
%opening
\title{Generating pleasant noises using microcontrollers}
%\author{Mark Carter \\ email \href{mailto:me@somewhere.com}}
%\author{Mark Carter}
\author{Mark Carter \\ alt.mcarter@gmail.com}
%\author{Mark Carter --- alt.mcarter@gmail.com}

\begin{document}
\maketitle
\thispagestyle{fancy}

\begin{abstract}

A common MCU (microcontrollers) project is the generation of noise for sleep or other purposes. Most projects found on the internet demonstrate how MCUs can be used to generate white noise. However, white noise sounds harsh, or ``tinny'', to humans. Brown noise is more pleasant, but it is difficult to find literature on how to generate it simply.

This paper explains how an approximation to Brown noise can be produced using a cheap MCU, a resistor, and a capacitor. A model and simulation of the underlying electrical theory is presented.
\end{abstract}

\section{Introduction}
Humans hear in the range 20-20kHz \cite{wikihearing}. 
Noise-making machines are often used to promote sleep. They are not particularly cheap, costing around Â£30 as at July 2019. It is easy to produce white noise using hobbiest MCUs like an Arduino Uno. The following sketch for the Arduino IDE shows just how simple it is:
\begin{verbatim}
void setup() {
  pinMode(12, OUTPUT);
}

void loop() {
  digitalWrite(12, random(2));
}
\end{verbatim} 
The code can be adapted easily to work with a variety of MCUs. Halfacree \cite{halfacree} elaborates on this idea by creating a project called the Sleepduino, consisting of an MCU, a potentiometer, some LEDs and a speaker.  The source file is available on github \cite{sleepduino}. It uses its own algorithm to generate random numbers, although this would not appear to be necessary, as the Arduino IDE already provides a random number generator.

The problem with white noise is that it is unpleasant to human ears. There is too much hissing to it \cite{gulf}, which is caused by the ear's perception of loudness at the higher frequencies. In order to produce a more pleasing sound, the energy output at the higher frequencies needs to be attenuated.

\section{Measurement of sound}

For \emph{power} quantities, a decibel (dB) is defined as: https://en.wikipedia.org/wiki/Decibel
\begin{equation}
 L_P = 10 \log_{10}\left(\frac{P}{P_0}\right)
\end{equation}
where $P$ is the measured power, and $P_0$ is the reference power.

For \emph{field} quantities, such as voltages and amplitudes, it is defined as:

\begin{equation}
 L_F = 10 \log_{10}\left(\frac{F^2}{F^2_0}\right) \equiv 20 \log_{10}\left(\frac{F}{F_0}\right)
\end{equation}

where $F$ is the measured field value, and $F_0$ is the reference field value.

The dB is therefore a relative to some reference value, rather than absolute one. Note that if an amplitude or voltage halves, its dB changes by approximately -6 dB $( = 20 \log_{10}\frac{1}{2})$.

Consider the representation of amplitudes in a sound file, where each sound sample is represented by an unsigned 8-bit byte. Each byte has a minimum value of 0, and a maximum value of 255 inclusive. Choosing $F_0$ to be the value 255, it follows that the dB value for an amplitude of 255 is 0dB. An amplitude of 128, it is approximately half of 255, therefore measures as $\approx$-6dB.
\section{White noise}
This section defines white noise and ...

White noise is a random signal having equal intensity at different frequencies, giving it a constant power spectral density\cite{wiki_white}. Its spectrum looks like this:

\begin{center}
\includegraphics[height=6cm]{white.png}
\end{center}

A typical 10s sample generated using the code (\code{white.c}):
\begin{Verbatim}[tabsize=8]
#include <assert.h>
#include <stdio.h>
#include <stdlib.h>

int main()
{
	FILE* fp = fopen("noise.raw", "wb");
	assert(fp);
	for(int i = 0; i<80000; ++i) {
		int v = rand() % 256;
		fprintf(fp, "%c", v);
	}
	fclose(fp);
	return 0;
}
\end{Verbatim}





\appendix

\section{Appendix: for which no-one has found a use}

Now is the winter of our discontent.
\begin{equation*}
  f(x) = x^2
\end{equation*}

\begin{thebibliography}{9}
 
\bibitem{halfacree}
Halfacree, Gareth.
\textit{Introducing the Sleepduino}
2012 
\\\texttt{https://is.gd/5zEFYt}
Extracted 2 July 2019



\bibitem{sleepduino}
Cox, Patrick.
\textit{Basic version of the Sleepduino.}
\\\texttt{https://github.com/patcox/Sleepduino}

\bibitem{gulf}
Gulf Coast Audiology.
\textit{White, Pink or Brown: Which Noise Helps You Sleep Better?}
\\\texttt{https://is.gd/41EOqr}

\bibitem{wikihearing}
Wikipedia.
\textit{Hearing range}
\\\texttt{https://en.wikipedia.org/wiki/Hearing\_range}

\bibitem{wiki_white}
Wikipedia.
\textit{White noise}
\\\texttt{https://en.wikipedia.org/wiki/White\_noise}

\bibitem{wiki_colour}
Wikipedia.
\textit{Colors of noise}
\\\texttt{https://en.wikipedia.org/wiki/Colors\_of\_noise}

\bibitem{audacity}
Audacity.
\textit{Free, open source, cross-platform audio software}
\\\texttt{https://www.audacityteam.org/}

\end{thebibliography}


\end{document}
